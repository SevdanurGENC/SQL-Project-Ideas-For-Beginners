SELECT ITMSC.NAME,OTRNS.AMOUNT, OTRNS.SHIPPEDAMOUNT, USLINE.CODE, OTRNS.DATE_,CLNTC.CODE, CLNTC.DEFINITION_ FROM LG_006_01_ORFICHE ORFIC,LG_006_ITEMS ITMSC,LG_006_01_ORFLINE OTRNS WITH(NOLOCK) LEFT OUTER JOIN LG_006_CLCARD CLNTC WITH(NOLOCK) ON (OTRNS.CLIENTREF = CLNTC.LOGICALREF) LEFT OUTER JOIN LG_006_UNITSETL USLINE WITH(NOLOCK) ON (OTRNS.UOMREF = USLINE.LOGICALREF) WHERE (OTRNS.ORDFICHEREF = ORFIC.LOGICALREF) AND (OTRNS.STOCKREF = ITMSC.LOGICALREF) AND (OTRNS.DETLINE <> 1) AND (OTRNS.CPSTFLAG <> 1) AND (OTRNS.SOURCEINDEX IN (0)) AND ORFIC.TRCODE IN(1)  AND (ITMSC.CARDTYPE IN (21,20,10,11,12,1,2,3,4,13)) AND ((NOT OTRNS.LINETYPE IN (2,3,4))) AND (OTRNS.AMOUNT<>OTRNS.SHIPPEDAMOUNT)ORDER BY ORFIC.DATE_